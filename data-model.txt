nodes
  code
  name
  lat
  lon
  parent      // can be used for both subnational and regions


oddata
  origin
  dest
  attr1: value
  attr2: value
  ..
  timestamp



data
  node
  attr1: value
  attr2: value
  ..
  attr1desc: description
  attr2desc: description
  ..
  value
  timestamp



hierarchical
  data
  filter



use cube?
http://square.github.com/cube/


{
  "type": "aid",   // trade, refugees
  "time": "2012-06-19T10:05:12.239Z",
  "data": {
    "origin": "ADK",
    "dest": 202,
    "value": 200,
    "purpose": 22000
  }
}

hierarchy of the purposes?

{
  "type": "hdi",
  "time": "2012-06-19T10:05:12.239Z",
  "data": {
    "country": "ADK",
    "value": 200,
  }
}



Goals
======

  P1 - Allow filtering by purpose

  P2 - Allow mashing with other datasets (world bank etc)

  P2 - Allow filtering queries by other data
      e.g.
          - flows of all countries in which HDI was 
          - show me countries whichHDI 

          - query/isolate flows/nodes by any variable  
            (like crossfilter, but with variable filters)

  P3 - Subnational

  P3 - Allow to aggregate on different levels


Why MongoDB / Cube ?
====================

  - Might be faster than PostgreSQL
       => might be the deal breaker, because it's impossible to precompute all complex queries 
          ??? depends on the type of queries

  - Cube does aggregation caching => this makes the infrastructure simpler

  - Easy to add new types of data with new properties - now "CREATE TABLE" needed 
      => unified way of storing all the different datasets

  - Cube collectors allow to easily add new events 
   (see https://github.com/square/cube/wiki/Collector)

  - Map/reduce, i.e. easy to aggregate on different levels



TO EXPLORE 
==========
  - Is the aggregation fast enough?

  - How to make the visualizations independent from the backend?


    The backend should not 

  - Do we need Cube or is MongoDB enough?











